(this["webpackJsonpjourney-weather"]=this["webpackJsonpjourney-weather"]||[]).push([[0],{31:function(e,t,n){e.exports=n(59)},36:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(27),r=n.n(i),c=(n(36),n(29)),l=n(1),s=n(9),u=n(10),d=n(7),m=n(12),p=n(11),h=function(e){var t=e.title;return o.a.createElement("div",null,o.a.createElement("h2",{className:"mt-3 text-center",id:"headerBar"}," ",t," "))},g=n(28),v=n.n(g);function y(e,t){for(var n=0;n<t.length;n++)if(t[n].key===e)return!0;return!1}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null===e||""===e||!1!==(y("key",t)||y("appid",t))){var a="";t.forEach((function(e,t){a+=0===t?"?"+e.key+"="+e.value:"&"+e.key+"="+e.value}));var o="".concat(e).concat(a);return n&&0!==Object.keys(n).length||(n={"Content-Type":"application/json"}),new Promise((function(e,t){v.a.get(o,{headers:n}).then((function(t){e(t)})).catch((function(e){console.error(e),t(e)}))}))}console.info("BaseURI && apiKey is not valid")},w=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"renderDirections",value:function(){var e=[];return this.props.directionsInHTMLFormat.forEach((function(t){e.push(o.a.createElement("tr",null,o.a.createElement("td",null,function(e){var t=new Date(1e3*e),n=t.getHours(),a=t.getMinutes(),o=t.toISOString().substr(5,5);return"".concat(o," ~ ").concat(n,":").concat(a)}(t.unixTimeStamp)),o.a.createElement("td",{dangerouslySetInnerHTML:{__html:t.direction}})))})),e}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("table",{className:"table table-striped"},o.a.createElement("thead",{className:"thead-dark"},o.a.createElement("tr",null,o.a.createElement("th",{scope:"col"},"Date(MM-DD) ~ Time"),o.a.createElement("th",{scope:"col"},"Direction"))),o.a.createElement("tbody",null,this.renderDirections())))}}]),n}(a.Component),b=null,E=null,k=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={directionsInHTMLFormat:[]},a.getDataFromDirectionsAPI=a.getDataFromDirectionsAPI.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.directionsInHTMLFormat.length!==t.directionsInHTMLFormat.length}},{key:"getDataFromDirectionsAPI",value:function(){var e=this,t=[{key:"origin",value:this.props.source},{key:"destination",value:this.props.destination},{key:"key",value:"AIzaSyBliI96c0HBIH6n-C2OofgxK_CBhyVoC0k"}];f("https://cors-anywhere.herokuapp.com/https://maps.googleapis.com/maps/api/directions/json",t).then((function(t){var n=t.data.routes[0].legs[0].start_location.lat,a=t.data.routes[0].legs[0].start_location.lng,o=t.data.routes[0].legs[0].end_location.lat,i=t.data.routes[0].legs[0].end_location.lng;e.weatherForUniqueCities(t.data.routes[0].legs[0].steps),e.setState({directionsInHTMLFormat:e.htmlDirections(t.data.routes[0].legs[0].steps,e.props.dateTimeObjectToUnix)}),e.initMap(n,a,o,i)}))}},{key:"weatherForUniqueCities",value:function(e){var t=this,n=[],a=[],o=this.props.dateTimeObjectToUnix,i=0;e.forEach((function(r){var c=[{key:"lat",value:r.end_location.lat},{key:"lon",value:r.end_location.lng},{key:"appid",value:"3e29e62e2ddf6dd3d2ebd28aed069215"}];f("https://api.openweathermap.org/data/2.5/forecast",c,{}).then((function(c){if(i++,c&&c.data.city&&!n.includes(c.data.city.name)){n.push(c.data.city.name),o+=r.duration.value;for(var l=0;l<c.data.list.length;l++){var s=c.data.list[l];if(o<s.dt){a.push({cityLat:c.data.city.coord.lat,cityLong:c.data.city.coord.lon,city:c.data.city.name,conditions:s.weather[0].description,temperature:"".concat(Math.round(9*(s.main.temp-273.15)/5+32),"\xb0F"),weatherIcon:"https://openweathermap.org/img/wn/".concat(s.weather[0].icon,"@2x.png")});break}}}i===e.length&&t.setMarkers(window.map,a)}))}))}},{key:"setMarkers",value:function(e,t){for(var n=0;n<t.length;n++){var a=new window.google.maps.LatLng(t[n].cityLat,t[n].cityLong);new window.google.maps.Marker({position:a,map:e,icon:t[n].weatherIcon,label:{color:"#00aaff",fontWeight:"bold",fontSize:"14px",text:t[n].temperature},size:20})}}},{key:"htmlDirections",value:function(e,t){var n=[];return e.forEach((function(e){t+=e.duration.value,n.push({unixTimeStamp:t,direction:e.html_instructions})})),n}},{key:"initMap",value:function(e,t,n,a){var o=new window.google.maps.LatLng(e,t),i=new window.google.maps.LatLng(n,a);window.map=new window.google.maps.Map(document.getElementById(this.props.id),this.props.myOptions),null!=b&&(b.setMap(null),b=null),E=new window.google.maps.DirectionsService,(b=new window.google.maps.DirectionsRenderer).setMap(window.map),this.calculateAndDisplayRoute(E,b,o,i)}},{key:"calculateAndDisplayRoute",value:function(e,t,n,a){e.route({origin:n,destination:a,travelMode:window.google.maps.TravelMode.DRIVING},(function(e,n){"OK"===n?t.setDirections(e):window.alert("Directions request failed due to "+n)}))}},{key:"render",value:function(){var e=this.state.directionsInHTMLFormat;return o.a.createElement("div",null,o.a.createElement("div",{style:{width:"100%",height:"700px"},id:this.props.id},this.getDataFromDirectionsAPI()),e.length>0?o.a.createElement(w,{directionsInHTMLFormat:e}):null)}}]),n}(a.Component),D=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={clientsPosition:{lat:37.0902,lng:95.7129},usersDestionationLocation:null,usersOriginLocation:null,dateTimeObjectToUnix:null},a.buttonClick=a.buttonClick.bind(Object(d.a)(a)),a.onScriptLoad=a.onScriptLoad.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onScriptLoad",value:function(){var e={center:this.state.clientsPosition,zoom:8};window.map=new window.google.maps.Map(document.getElementById("googleMap"),e)}},{key:"componentDidMount",value:function(){var e=this;if(this.clientCoordinates(),window.google)this.onScriptLoad();else{var t=document.createElement("script");t.type="text/javascript",t.src="".concat("https://maps.googleapis.com/maps/api/js","?key=").concat("AIzaSyBliI96c0HBIH6n-C2OofgxK_CBhyVoC0k");var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),t.addEventListener("load",(function(t){e.onScriptLoad()}))}}},{key:"clientCoordinates",value:function(){var e=this,t=this.state.clientsPosition;navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(n){t={lat:n.coords.latitude,lng:n.coords.longitude},e.setState({clientsPosition:t})}))}},{key:"buttonClick",value:function(){var e=document.getElementById("usersOriginLocation").value,t=document.getElementById("usersDestionationLocation").value,n=document.getElementById("journeyStartTime").value,a=document.getElementById("journeyStartDate").options[document.getElementById("journeyStartDate").selectedIndex].text;if(t||e||!n||!a){var o=new Date("".concat(a,"T").concat(n)).getTime()/1e3;this.setState({usersOriginLocation:e,usersDestionationLocation:t,dateTimeObjectToUnix:o})}}},{key:"loadTimeOptions",value:function(){var e=new Date,t=[],n=e.toISOString().substr(0,10);t.push(o.a.createElement("option",{value:n},n));for(var a=1;a<3;a++)e.setDate(e.getDate()+1),n=e.toISOString().substr(0,10),t.push(o.a.createElement("option",{value:n},n));return t}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(h,{title:"Journey-weather"}),o.a.createElement("form",{className:"form-inline container justify-content-center"},o.a.createElement("input",{type:"text",className:"form-control col-xl-2 ml-2 mr-2",id:"usersOriginLocation",placeholder:"Origin"}),o.a.createElement("input",{type:"text",className:"form-control col-xl-2 ml-2 mr-2",id:"usersDestionationLocation",placeholder:"Destination"}),o.a.createElement("select",{id:"journeyStartDate",className:"form-control col-xl-2 ml-2 mr-2"},this.loadTimeOptions()),o.a.createElement("input",{id:"journeyStartTime",className:"form-control col-xl-2 ml-2 mr-2",type:"time",step:"1800",required:!0}),o.a.createElement("button",{type:"button",className:"btn btn-success col-xl-1 ml-2 mr-2",onClick:this.buttonClick,id:"search-button"},"Let's go")),o.a.createElement("br",null),this.state.usersOriginLocation&&this.state.usersDestionationLocation&&this.state.dateTimeObjectToUnix?o.a.createElement(k,{id:"googleMap",source:this.state.usersOriginLocation,destination:this.state.usersDestionationLocation,dateTimeObjectToUnix:this.state.dateTimeObjectToUnix}):null)}}]),n}(a.Component);var O=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(c.a,null,o.a.createElement(l.c,null,o.a.createElement(l.a,{exact:!0,path:"/",component:D}),o.a.createElement(l.a,{path:"*",component:D}))))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(O,null)),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.d208cee9.chunk.js.map